@using Bible_Blazer_PWA.Components.Interactor.LessonUnits;
@using static Bible_Blazer_PWA.Components.Interactor.Interaction;
@inherits InteractionContainerComponent
<MudPaper>
    @InteractionRender
</MudPaper>
@code {

    [Parameter]
    public InteractionPanel InteractionPanelComponent { get; set; }

    private RenderFragment? InteractionRender { get; set; }

    public override void SetInteractionModel(IInteractionModel model, bool fromTurnoverEvent = false)
    {
        InteractionRender = builder =>
        {
            builder.OpenComponent(1, model.ComponentType);
            builder.AddAttribute(2, "InteractionModel", model);
            builder.CloseComponent();
        };
    }

    public override void Refresh()
    {
        StateHasChanged();
    }

    public bool DisableRenderOnes { get; set; }

    protected override bool ShouldRender()
    {
        if (DisableRenderOnes)
            return DisableRenderOnes = false;

        return true;
    }

    protected override void OnInitialized()
    {
        Interaction.SetMainContainer(this);
        LessonUnitsInteractionModel.Apply(true);
    }
}
