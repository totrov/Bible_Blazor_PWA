@page "/dbtest"
@inject IJSRuntime JS;
@using Bible_Blazer_PWA.DataBase;
@inject DatabaseJSFacade db;

<h3>DataBaseTest</h3>

<button type="button" class="btn btn-primary" @onclick="Test">
   Test interop
</button>

<button type="button" class="btn btn-primary" @onclick="Test2">
    Test 2
</button>
<button type="button" class="btn btn-primary" @onclick="Test3">
    Test 3
</button>

<p class="mt-2" style="font-size:1.6em">
    <span class="badge badge-success">
        @text
    </span>
</p>

@code {
    private string text = "empty";

    private async Task Test()
    {
        text = await db.Test();
    }

    private async Task Test2()
    {
        IndexedDBResultHandler<int> resultHandler = await db.CallDbAsync<int>(null, "test", "js");
        resultHandler.OnDbResultOK += () => { text = resultHandler.Result.ToString(); StateHasChanged(); };
    }
    private async Task Test3()
    {
        IndexedDBResultHandler<BibleService.Book> resultHandler = await db.CallDbAsync<BibleService.Book>(null, "getRecordFromObjectStoreByKey", "books", 30);
        resultHandler.OnDbResultOK += () => { text = resultHandler.Result.Name; StateHasChanged(); };
        
    }
}


